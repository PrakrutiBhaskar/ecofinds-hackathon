{% extends "marketplace/base.html" %}
{% block content %}
<h1 class="text-2xl font-bold mb-4">Browse Listings</h1>

<form method="get" class="flex flex-wrap gap-2 items-center mb-4">
  <input type="text" name="q" value="{{ q }}" placeholder="Search title..."
         class="flex-1 p-2 border rounded">
  <select name="category" class="p-2 border rounded">
    <option value="">All categories</option>
    {% for key,label in categories.items %}
      <option value="{{ key }}" {% if key == active_category %}selected{% endif %}>{{ label }}</option>
    {% endfor %}
  </select>
  <button class="bg-green-600 text-white px-4 py-2 rounded">Apply</button>
</form>

<div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
  {% for p in products %}
    <a class="block bg-white rounded shadow overflow-hidden" href="{% url 'product_detail' p.pk %}">
      {% if p.image %}
        <img class="w-full h-40 object-cover" src="{{ p.image.url }}" alt="{{ p.title }}">
      {% else %}
        <img class="w-full h-40 object-cover" src="/static/img/placeholder.png" alt="placeholder">
      {% endif %}
      <div class="p-3">
        <div class="font-semibold">{{ p.title }}</div>
        <div class="text-green-700 font-bold mt-1">â‚¹ {{ p.price }}</div>
      </div>
    </a>
  {% empty %}
    <p>No listings yet.</p>
  {% endfor %}
</div>
{% endblock %}
